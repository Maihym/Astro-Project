---
// Enhanced Service Page Template for First Electric - Local SEO Optimized
// This template provides a comprehensive structure for service pages
// that fully complies with Google Local SEO best practices

import Layout from '../../layouts/Layout.astro';
import { getServiceBySlug, getAllServices, getAllCities } from '../../lib/data';
import type { Service } from '../../lib/data';

// Import service page components
import ServiceHero from '../../components/ServiceHero.astro';
import ServiceTrustSignals from '../../components/ServiceTrustSignals.astro';
import ServiceBenefits from '../../components/ServiceBenefits.astro';
import ServiceSpecifications from '../../components/ServiceSpecifications.astro';
import ServiceFeatures from '../../components/ServiceFeatures.astro';
import ServiceProcess from '../../components/ServiceProcess.astro';
import ServiceExpertise from '../../components/ServiceExpertise.astro';
import ServiceTechnical from '../../components/ServiceTechnical.astro';
import ServiceTestimonials from '../../components/ServiceTestimonials.astro';
import ServiceLocalArea from '../../components/ServiceLocalArea.astro';
import ServiceFAQ from '../../components/ServiceFAQ.astro';
import ServiceFinalCTA from '../../components/ServiceFinalCTA.astro';

export async function getStaticPaths() {
  const services = getAllServices();
  return services.map((service) => ({
    params: { service: service.slug },
    props: { service },
  }));
}

interface Props {
  service: Service;
}

const { service } = Astro.props;
const cities = getAllCities();

// Generate enhanced schema markup for local SEO
function generateServiceSchema(service: Service) {
  return {
    "@context": "https://schema.org",
    "@type": "Service",
    "name": service.title,
    "description": service.description,
    "provider": {
      "@type": "Electrician",
      "name": "First Electric LLC",
      "telephone": "(657) 239-6331",
      "email": "contact@firstelectric.pro",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "12310 La Pomelo Rd",
        "addressLocality": "La Mirada",
        "addressRegion": "CA",
        "postalCode": "90638",
        "addressCountry": "US"
      },
      "hasCredential": {
        "@type": "EducationalOccupationalCredential",
        "credentialCategory": "license",
        "name": "C-10 Electrical Contractor License",
        "identifier": "1120441"
      }
    },
    "serviceType": service.title,
    "category": "Electrical Services",
    "areaServed": [
      {
        "@type": "City",
        "name": "La Mirada",
        "containedInPlace": {
          "@type": "State",
          "name": "California"
        }
      },
      {
        "@type": "City",
        "name": "Whittier",
        "containedInPlace": {
          "@type": "State",
          "name": "California"
        }
      },
      {
        "@type": "City",
        "name": "Cerritos",
        "containedInPlace": {
          "@type": "State",
          "name": "California"
        }
      }
    ],
    "hasOfferCatalog": {
      "@type": "OfferCatalog",
      "name": `${service.title} Services`,
      "itemListElement": service.features.map((feature, index) => ({
        "@type": "Offer",
        "itemOffered": {
          "@type": "Service",
          "name": feature
        },
        "position": index + 1
      }))
    },
    "offers": {
      "@type": "Offer",
      "priceRange": "$$",
      "availability": "https://schema.org/InStock",
      "validFrom": new Date().toISOString().split('T')[0],
      "priceCurrency": "USD",
      "description": "Free estimates available for all electrical services"
    }
  };
}

// Generate FAQ schema for local SEO
function generateFAQSchema(service: Service) {
  return {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": `How quickly can you respond to ${service.title.toLowerCase()} in La Mirada?`,
        "acceptedAnswer": {
          "@type": "Answer",
          "text": `We typically respond to ${service.title.toLowerCase()} requests in La Mirada within 60 minutes, 24/7. Our team is strategically located to serve the entire La Mirada area quickly, and we stock common parts to resolve most issues on the first visit.`
        }
      },
      {
        "@type": "Question",
        "name": `Do you offer free estimates for ${service.title.toLowerCase()}?`,
        "acceptedAnswer": {
          "@type": "Answer",
          "text": `Yes, we provide free estimates for all ${service.title.toLowerCase()} services. Our licensed electricians will assess your electrical needs and provide a detailed estimate with no obligation.`
        }
      },
      {
        "@type": "Question",
        "name": "Are you licensed and insured for electrical work in California?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, First Electric LLC is a licensed C-10 electrical contractor (License #1120441) and fully insured. We are bonded and carry comprehensive liability insurance to protect your property and our work."
        }
      },
      {
        "@type": "Question",
        "name": "What areas do you serve for electrical services?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "We serve La Mirada, Whittier, Cerritos, Buena Park, La Habra, Santa Fe Springs, and surrounding areas in Los Angeles and Orange Counties. Contact us to confirm service availability in your specific location."
        }
      }
    ]
  };
}

const serviceSchema = generateServiceSchema(service);
const faqSchema = generateFAQSchema(service);
---

<Layout 
  title={service.seo.title} 
  description={service.seo.description}
  service={service}
  breadcrumbs={[
    { name: "Home", url: "/" },
    { name: "Services", url: "/services" },
    { name: service.title, url: `/services/${service.slug}` }
  ]}
>
  <!-- Enhanced Schema Markup for Local SEO -->
  <script type="application/ld+json" set:html={JSON.stringify(serviceSchema)}></script>
  <script type="application/ld+json" set:html={JSON.stringify(faqSchema)}></script>
  <main class="min-h-screen bg-background">
    <!-- Hero Section -->
    <ServiceHero service={service} />

    <!-- Trust Signals Section -->
    <ServiceTrustSignals />

    <!-- Benefits Section -->
    <ServiceBenefits service={service} />

    <!-- Service Specifications Section -->
    <ServiceSpecifications service={service} />

    <!-- Service Features Section -->
    <ServiceFeatures service={service} />

    <!-- Process Section -->
    <ServiceProcess service={service} />

    <!-- Local Expertise Section -->
    <ServiceExpertise service={service} />

    <!-- Technical Details Section -->
    <ServiceTechnical service={service} />

    <!-- Testimonials Section -->
    <ServiceTestimonials service={service} />

    <!-- Local Area Section -->
    <ServiceLocalArea service={service} />

    <!-- FAQ Section -->
    <ServiceFAQ service={service} />

    <!-- Final CTA Section -->
    <ServiceFinalCTA service={service} />

  </main>
</Layout>
